<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>EmailGenie Dialog</title>
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/tinymce@7.8.0/tinymce.min.js"
      defer=""
    ></script>
  </head>
  <body>
    <h3>This is a modal dialog!</h3>
    <button onclick="sendMessage()">Send Message</button>

    <form method="post">
      <textarea id="tinymce-default">Hello, &lt;b&gt;Tabler&lt;/b&gt;!</textarea
      >
    </form>

    <script>
      Office.onReady(() => {
        console.log("Dialog ready.");

        document.addEventListener("DOMContentLoaded", function () {
          let options = {
            selector: "#tinymce-default",
            height: 300,
            menubar: true,
            statusbar: true,
            plugins: [
              "advlist autolink lists link image charmap print preview anchor",
              "searchreplace visualblocks code fullscreen",
              "insertdatetime media table paste code help wordcount",
            ],
            toolbar:
              "undo redo | formatselect | " +
              "bold italic backcolor | alignleft aligncenter " +
              "alignright alignjustify | bullist numlist outdent indent | " +
              "removeformat",
            content_style:
              "body { font-family: -apple-system, BlinkMacSystemFont, San Francisco, Segoe UI, Roboto, Helvetica Neue, sans-serif; font-size: 14px; -webkit-font-smoothing: antialiased; }",
          };
          if (localStorage.getItem("tablerTheme") === "dark") {
            options.skin = "oxide-dark";
            options.content_css = "dark";
          }
          tinyMCE.init(options);
        });
      });

      function sendMessage() {
        Office.context.ui.messageParent("Dialog says hello!");
      }
    </script>
  </body>
</html>
